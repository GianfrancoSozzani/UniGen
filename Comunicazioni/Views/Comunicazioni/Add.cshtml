@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@

@model Comunicazioni.Models.AddComunicazioneViewModel
<div class="container">


	<h1>Nuova Comunicazione</h1>
	<div class="row gx-5">
		<div class="col-9">
			@{
				var ruolo = Context.Session.GetString("Ruolo");
			}

			@if (ruolo == "D")
			{
				<form method="post" asp-action="AddStudente">
					<div class="mt-3">
						<label class="form-label">Esame:</label>
						<select asp-for="K_Esame" asp-items="@ViewBag.EsamiList" class="form-select" onchange="this.form.submit()">
							<option disabled selected>-- Seleziona un esame --</option>
						</select>
						<span asp-validation-for="K_Esame" class="text-danger"></span>
					</div>
				</form>
			}

			<form method="post" asp-action="Add">
				@if (ruolo == "D" && ViewBag.SelectedKEsame != null)
				{
					<input type="hidden" asp-for="K_Esame" value="@ViewBag.SelectedKEsame" />
				}
				@if (ruolo == "D")
				{
					<div class="mt-3">
						<label class="form-label">Destinatari:</label>
						<select asp-for="K_Studente" asp-items="@ViewBag.StudentiList" class="form-select">
							<option selected disabled>-- Seleziona un destinatario --</option>
							<option value="1">Amministrazione</option>
						</select>
						<span asp-validation-for="K_Studente" class="text-danger"></span>
					</div>
				}
				@if (ruolo == "O")
				{
					<div class="mt-3">
						<label class="form-label">Studenti:</label>
						<select asp-for="K_Studente" asp-items="@ViewBag.StudentiList" class="form-select">
							<option selected disabled>-- Seleziona uno studente --</option>
						</select>
						<span asp-validation-for="K_Studente" class="text-danger"></span>
					</div>

					<div class="mt-3">
						<label class="form-label">Docenti:</label>
						<select asp-for="K_Docente" asp-items="@ViewBag.DocentiList" class="form-select">
							<option selected>-- Seleziona un docente --</option>
						</select>
						<span asp-validation-for="K_Docente" class="text-danger"></span>
					</div>
				}
				@if (ruolo == "S")
				{
					<div class="mt-3">
						<label class="form-label">Destinatari:</label>
						<select asp-for="K_Docente" asp-items="@ViewBag.DocentiList" class="form-select">
							<option selected>-- Seleziona un destinatario --</option>
							<option value="Amministrazione">Amministrazione</option>
						</select>
						<span asp-validation-for="K_Docente" class="text-danger"></span>
					</div>
				}
				<div class="mt-4">
					<label class="form-label">Testo:</label>
					<textarea asp-for="Testo" class="form-control" rows="6"></textarea>
					<span asp-validation-for="Testo" class="text-danger"></span>
					<button type="submit" class="btn btn-primary mt-3">Inserisci Comunicazione</button>
				</div>
			</form>
		</div>
		<div class="col-3 shadow p-3 bg-body-tertiary rounded">
			Nella pagina corrente, il docente e l'amministrazione possono inserire una comunicazione.
		</div>
	</div>

</div>




